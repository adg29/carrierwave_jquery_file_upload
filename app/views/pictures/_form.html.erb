<%= content_for :head do %>
  <%= stylesheet_link_tag "http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.13/themes/base/jquery-ui.css", :id => "theme" %>
  <%= javascript_include_tag "http://ajax.aspnetcdn.com/ajax/jquery.templates/beta1/jquery.tmpl.min.js" %>
  <script type="text/javascript">
  $(function(){
  	$('#picture_remote_file_url')
		.focus(function(){
			if( $(this).val().substr(0,5)=="Paste" ){
				$(this).val('');
			}
		})
		.blur(function(){
			$('#upload_start').css('display','block');
			$('#description_input').css('display','block');
			$('.fileupload-buttonbar').css('left',200);
			$('.fileinput-button,#picture_file').css('display','none');
			<% if @uploadtype=="a video" %>
			if( $('#picture_remote_file_url').val().indexOf('youtube')!=-1 ){
				var yt_meta = gYoutube();
				console.log('youtube');
				console.log(yt_meta);
				$('.files').html( $.tmpl( $('#template-upload').html(), {} ) );
				$('.files .preview').html( '<div class="thumb_paste"><img src="'+yt_meta['picture']['remote_file_url']+'"/></div>');
			}
			<% else %>
			console.log('paste');
			$('.files').html( $.tmpl( $('#template-upload').html(), {} ) );
			$('.files .preview').html( '<div class="thumb_paste"><img src="'+$('#picture_remote_file_url').val()+'"/></div>');
			<% end %>
		});
  	$('#picture_description')
		.focus(function(){
			if( $(this).val().substr(0,3)=="Add" ){
				$(this).val('');
			}
		})
  });
  </script>
<% end %>

<div id="fileuser">
	<div id="fbavatar"></div>
	<div id="fbavatar_copy">
		<h1 id="fbusername"></h1>
		<div id="mosaic_copy">
		Join the mosaic by submitting <%= @uploadtype %> that best represents you and your city.
		</div>
	</div>
</div>

<div id="fileupload">
  <%= form_for @picture, :html => { :multipart => true } do |f| %>
      <%= f.label :remote_file_url, "Link Image" %>
      <p>
	<%= f.text_field :remote_file_url , :value => "Paste #{@uploadtype} link here"%>
      </p>

      <div class="field">
        <%= f.hidden_field :city_id ,:value => @city.id %>
      </div>
      <%= f.fields_for :user do |user| %>
	      <div class="field" id="fb-name">
		<%= user.hidden_field :name %>
	      </div>
	      <div class="field" id="fb-locale">
		<%= user.hidden_field :locale%>
	      </div>
	      <div class="field" id="fb-id">
		<%= user.hidden_field :fbid %>
	      </div>
      <% end %>
      <br />
      
      <div class="fileupload-buttonbar" style="<% if( @uploadtype=="a video") %>display: none;<% end %>">
          <div id="description_input" class="field">
              <%= f.text_area :description , :value => 'Add a caption to your upload' %>
          </div>

          <label class="fileinput-button">
	      Or, Upload Image <br/>
          </label>
          <%= f.file_field :file %>
          <button id="upload_start" type="submit" class="start">Add Image</button>
      </div>
  <% end %>
  <div class="fileupload-content">
      <div class="files"></div>
      <div class="fileupload-progressbar"></div>
  </div>
</div>

<%= render :partial => "pictures/template-upload" %>
<%= render :partial => "pictures/template-download" %>
